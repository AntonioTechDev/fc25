# Multi-Automation System

**Autore:** Antonio De Biase  
**Versione:** 2.0.0  
**Data:** 2025-07-27

## üìã Descrizione

Sistema di automazione professionale modulare per la creazione automatica di account Outlook e PSN con GUI di monitoraggio log in tempo reale. Utilizza riconoscimento immagini per navigare attraverso i processi di registrazione.

## ‚ú® Caratteristiche Principali

- ü§ñ **Automazione completa** del processo di registrazione Outlook e PSN
- üîç **GUI di monitoraggio log** sempre visibile in tempo reale
- üéØ **Riconoscimento immagini** per navigazione precisa
- üîÑ **Cambio MAC address** automatico per ogni account
- üìä **Gestione CSV** degli account con tracking status
- üåê **Supporto browser** Chrome/Firefox in modalit√† incognito
- üé® **Colori differenziati** per livelli log (INFO, WARNING, ERROR)
- ‚ö° **Thread separati** per GUI e automazione
- üèóÔ∏è **Architettura modulare** scalabile e mantenibile
- üñ•Ô∏è **Supporto multi-monitor** con spostamento automatico finestra

## üöÄ Quick Start

### 1. Installazione Dipendenze

```bash
# Dipendenze Python
pip install -r requirements.txt

# Spoof-mac per cambio MAC address (macOS)
brew install spoof-mac

# Estendi timestamp sudo
sudo -v
```

### 2. Configurazione Sudo per Spoof-Mac

```bash
# Configura sudoers per spoof-mac (una sola volta)
echo "$(whoami) ALL=(ALL) NOPASSWD: /opt/homebrew/bin/spoof-mac" | sudo tee /etc/sudoers.d/spoof-mac

# Verifica configurazione
sudo -n /opt/homebrew/bin/spoof-mac randomize en0
```

### 3. Preparazione File

```bash
# Struttura progetto
Multi-Automation-System/
‚îú‚îÄ‚îÄ data/accounts.csv          # File con i dati degli account
‚îú‚îÄ‚îÄ templates/                 # Cartella con le immagini template
‚îÇ   ‚îú‚îÄ‚îÄ outlook_images/        # Template Outlook
‚îÇ   ‚îî‚îÄ‚îÄ psn_images/           # Template PSN
‚îú‚îÄ‚îÄ modules/                   # Moduli di automazione
‚îú‚îÄ‚îÄ core/                      # Funzioni core condivise
‚îú‚îÄ‚îÄ gui/                       # Interfaccia grafica
‚îî‚îÄ‚îÄ main.py                    # Punto di ingresso
```

### 4. Formato CSV

```csv
email,password,first_name,last_name,birth_year,status,psn_id,psn_email,psn_psw,data_creazione_psn,status_psn
user1@outlook.com,password123,Mario,Rossi,1990,,mariorossi517,user1@outlook.com,Psn2024!,,,
user2@outlook.com,password456,Giulia,Bianchi,1985,,giuliabianchi123,user2@outlook.com,Psn2024!,,,
```

### 5. Esecuzione

```bash
# Modalit√† CLI
python main.py --outlook      # Solo automazione Outlook
python main.py --psn          # Solo automazione PSN
python main.py --combined     # Outlook + PSN sequenziale
python main.py --gui          # GUI per selezione moduli
python main.py --stats        # Visualizzazione statistiche

# Modalit√† GUI
python main.py --gui
```

## üèóÔ∏è Architettura Modulare

### Struttura Directory

```
Multi-Automation-System/
‚îú‚îÄ‚îÄ README.md                  # üìñ Documentazione completa
‚îú‚îÄ‚îÄ requirements.txt           # üì¶ Dipendenze Python
‚îú‚îÄ‚îÄ main.py                    # Entry point principale
‚îú‚îÄ‚îÄ gui/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îî‚îÄ‚îÄ main_gui.py           # GUI condivisa
‚îú‚îÄ‚îÄ modules/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ outlook_automation.py # Modulo Outlook
‚îÇ   ‚îî‚îÄ‚îÄ psn_automation.py     # Modulo PSN
‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ base_automator.py     # Classe base per automator
‚îÇ   ‚îú‚îÄ‚îÄ common_functions.py   # Funzioni condivise
‚îÇ   ‚îú‚îÄ‚îÄ csv_handler.py        # Gestione CSV unificata
‚îÇ   ‚îî‚îÄ‚îÄ logger.py             # Sistema logging condiviso
‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îú‚îÄ‚îÄ outlook_images/       # Immagini Outlook
‚îÇ   ‚îî‚îÄ‚îÄ psn_images/          # Immagini PSN
‚îú‚îÄ‚îÄ data/
‚îÇ   ‚îî‚îÄ‚îÄ accounts.csv         # File dati condiviso
‚îî‚îÄ‚îÄ tests/
    ‚îî‚îÄ‚îÄ test_architecture.py # Test architettura
```

### Componenti Core

#### **core/base_automator.py**
- **Classe base astratta** per tutti gli automator
- **Interfaccia comune** e funzionalit√† condivise
- **Template matching** unificato
- **Gestione progresso** standardizzata

#### **core/common_functions.py**
- **Coordinate detection** e click/scroll operations
- **Data generation utilities** (PSN ID, password)
- **Image matching functions** condivise
- **Browser management** unificato
- **Multi-monitor support** integrato

#### **core/csv_handler.py**
- **Unified CSV operations** per tutti i moduli
- **Dynamic column management** automatico
- **Data validation/completion** intelligente
- **Backup automatico** con versioning

#### **core/logger.py**
- **Centralized logging system** per tutti i moduli
- **GUI integration hooks** per log in tempo reale
- **Module-specific log formatting** con colori
- **Thread-safe logging** per GUI

### Moduli di Automazione

#### **modules/outlook_automation.py**
- **Classe OutlookAutomator** ereditata da BaseAutomator
- **Logica specifica Outlook** completamente isolata
- **26 template** per riconoscimento elementi
- **21 step** di automazione

#### **modules/psn_automation.py**
- **Classe PSNAutomator** ereditata da BaseAutomator
- **Logica specifica PSN** completamente isolata
- **23 template** per riconoscimento elementi
- **23 step** di automazione

## ‚öôÔ∏è Configurazione

### File e Path
- `TEMPLATES_DIR`: Cartella con le immagini template
- `CSV_FILE_PATH`: Path al file CSV degli account

### Browser
- `BROWSER`: Browser da utilizzare ('chrome', 'firefox')
- `INCOGNITO_MODE`: Modalit√† incognito/privata
- `MOVE_BROWSER_TO_PRIMARY`: Sposta browser sul primo schermo (utile per multi-monitor)

### Automazione
- `ENABLE_PSN_AUTOMATION`: Abilita automazione PSN dopo Outlook
- `MATCH_CONFIDENCE`: Soglia matching immagini (0.4)
- `MAX_RETRIES`: Tentativi per template (3)

### Timing e Delay
- `PAGE_LOAD_DELAY`: Attesa dopo apertura browser (15s)
- `CLICK_DELAY`: Attesa tra ogni azione (8s)
- `ACCOUNT_DELAY`: Attesa tra account (30s)
- `MAC_WAIT_SECONDS`: Attesa dopo cambio MAC (10s)

## üñ•Ô∏è Supporto Multi-Monitor

### Rilevamento Automatico
- **Rilevamento multi-monitor**: Il sistema rileva automaticamente se ci sono pi√π monitor
- **Spostamento intelligente**: La finestra del browser viene spostata sul primo schermo solo se necessario
- **Configurazione opzionale**: Pu√≤ essere disabilitata impostando `MOVE_BROWSER_TO_PRIMARY = False`

### Come Funziona
1. **Rilevamento**: All'avvio, il sistema rileva il numero di monitor
2. **Apertura browser**: Il browser si apre normalmente
3. **Spostamento**: Se multi-monitor rilevato, la finestra viene spostata sul primo schermo
4. **Screenshot**: Gli screenshot vengono presi dal primo schermo dove ora si trova il browser

## üñ•Ô∏è GUI di Monitoraggio

La GUI si apre automaticamente nell'angolo basso-destra dello schermo:

- **Sempre in primo piano** (stay on top)
- **Auto-scroll** dei log in tempo reale
- **Colori per livelli log**:
  - üîµ INFO: Bianco
  - üü° WARNING: Arancione  
  - üî¥ ERROR: Rosso
- **Bottone Clear** per pulire i log
- **Contatore log** in tempo reale
- **Buffer limitato** a 1000 righe per performance

### Layout Modulare
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ [‚ñ∂Ô∏è Outlook] [‚ñ∂Ô∏è PSN] [‚ñ∂Ô∏è Combined]   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ üìä Progress: [‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë] 60%          ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ üìù Logs (Unified):                 ‚îÇ
‚îÇ [OUTLOOK] Email created...          ‚îÇ
‚îÇ [PSN] Account registration...       ‚îÇ
‚îÇ [SYSTEM] CSV updated...             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

## üéÆ Automazione PSN

L'automazione include la creazione automatica di account PSN utilizzando le email Outlook appena create.

### Caratteristiche
- **üîÑ Integrazione automatica** dopo creazione email Outlook
- **üñ•Ô∏è Sessione browser mantenuta** per verifica email futura
- **üìä Aggiornamento CSV** con dati PSN completi
- **üéÆ Generazione intelligente** PSN ID e password
- **üìã Template matching** per tutti i step PSN

### Flusso Operativo
1. **‚úÖ Email Outlook creata** con successo
2. **üÜï Nuova tab PSN** aperta automaticamente
3. **üìù Form PSN compilato** con dati correlati
4. **üéÆ Account PSN creato** con ID e password generati
5. **üìä CSV aggiornato** con tutti i dati PSN

### Dati PSN Generati
- **PSN ID**: Basato su nome/cognome + numeri casuali
- **PSN Email**: Stessa email Outlook
- **PSN Password**: Derivata dalla password Outlook
- **Data Creazione**: Timestamp automatico
- **Status**: SUCCESS/FAILED/PENDING_VERIFICATION

## üß™ Test e Verifica

### Test Completati
```bash
python tests/test_modular_architecture.py
```

### Risultati Test
- ‚úÖ **Core Logger**: Funzionante con moduli multipli
- ‚úÖ **CSV Handler**: Gestione unificata con 51 account
- ‚úÖ **Base Automator**: Classe base funzionante
- ‚úÖ **Outlook Automator**: 26 template, 21 step
- ‚úÖ **PSN Automator**: 23 template, 23 step
- ‚úÖ **Struttura Directory**: Tutte le directory create
- ‚úÖ **File Principali**: Tutti i file implementati
- ‚úÖ **Integrazione**: Sistema modulare funzionante

## üîß Dipendenze

### Python
- `opencv-python>=4.8.0` - Riconoscimento immagini
- `pyautogui>=0.9.54` - Automazione mouse/tastiera
- `pynput>=1.7.6` - Digitazione avanzata (opzionale)
- `numpy>=1.24.0` - Elaborazione array

### Sistema (macOS)
- `spoof-mac` - Cambio MAC address
- `sudo` - Permessi amministrativi

## üõ†Ô∏è Troubleshooting

### Cambio MAC Address Fallisce
```bash
# Verifica installazione spoof-mac
which spoof-mac

# Se non installato
brew install spoof-mac

# Configura sudoers per spoof-mac (una sola volta)
echo "$(whoami) ALL=(ALL) NOPASSWD: /opt/homebrew/bin/spoof-mac" | sudo tee /etc/sudoers.d/spoof-mac

# Test senza password
sudo -n /opt/homebrew/bin/spoof-mac randomize en0
```

### Template Non Trovati
- Verifica che le immagini siano nella cartella `templates/`
- Controlla i nomi file nella sequenza di automazione
- Assicurati che le immagini siano in formato PNG

### Browser Non Si Apre
- Verifica che Chrome/Firefox sia installato
- Controlla i permessi di esecuzione
- Prova a cambiare `BROWSER` in configurazione

## üìù Log e Debug

I log vengono mostrati sia nel terminale che nella GUI:

- **INFO**: Operazioni normali
- **WARNING**: Problemi non critici
- **ERROR**: Errori che bloccano l'operazione

### Esempi Log
```
2025-07-27 12:10:39 - üáÆüáπ Script multi-outlook-account avviato
2025-07-27 12:10:39 - üîç GUI di monitoraggio log attiva
2025-07-27 12:10:39 - üöÄ Avvio automazione multi-account
2025-07-27 12:10:39 - üîÑ Cambio MAC address su en0...
2025-07-27 12:10:39 - ‚úÖ MAC address cambiato con successo
```

## üîí Sicurezza

- **Dati sensibili** vengono mascherati nei log
- **Modalit√† incognito** per ogni sessione
- **Cambio MAC address** per evitare tracking
- **Gestione errori** robusta

## üöÄ Estensibilit√†

### Aggiungere Nuovi Moduli
```python
# modules/new_service_automation.py
class NewServiceAutomator(BaseAutomator):
    def __init__(self):
        super().__init__(
            service_name="new_service",
            image_folder="new_service_images"
        )
    
    def run_automation(self):
        # Implementation
        pass
```

### Plugin System
- **Auto-discovery**: Scan modules/ per automazioni
- **Dynamic loading**: Import runtime moduli
- **Consistent interface**: BaseAutomator class
- **Easy integration**: Hook standard per GUI/CSV/Log

## üìä Vantaggi dell'Architettura Modulare

### ‚úÖ **Modularit√†**
- **Separazione responsabilit√†**: Ogni modulo √® indipendente
- **Riutilizzabilit√†**: Componenti condivisi tra moduli
- **Manutenibilit√†**: Modifiche isolate per modulo
- **Testabilit√†**: Test unitari per ogni modulo

### ‚úÖ **Scalabilit√†**
- **Framework estendibile**: Nuovi moduli facilmente aggiungibili
- **Plugin system**: Auto-discovery di nuovi servizi
- **Configurazione flessibile**: Ogni modulo configurabile
- **Architettura evolutiva**: Preparata per future estensioni

### ‚úÖ **Robustezza**
- **Gestione errori**: Centralizzata e modulare
- **Logging avanzato**: Tracciamento completo delle operazioni
- **Backup automatico**: Protezione dati con versioning
- **Validazione dati**: Controlli di consistenza integrati

### ‚úÖ **Usabilit√†**
- **GUI unificata**: Interfaccia per tutti i moduli
- **CLI flessibile**: Opzioni multiple per esecuzione
- **Monitoraggio real-time**: Progress e log in tempo reale
- **Statistiche avanzate**: Metriche complete del sistema

## üîÆ Roadmap Futura

### v2.1.0 - Miglioramenti Imminenti
- [ ] Configurazione GUI per modificare parametri runtime
- [ ] Pausa/Riprendi automazione dalla GUI
- [ ] Statistiche account processati
- [ ] Export log in file
- [ ] Tema scuro/chiaro

### v3.0.0 - Funzionalit√† Avanzate
- [ ] Supporto Windows e Linux completo
- [ ] API REST per controllo remoto
- [ ] Integrazione con database
- [ ] Plugin system avanzato
- [ ] Machine learning per riconoscimento

## üìÑ Licenza

Progetto privato per uso personale.

## ü§ù Supporto

Per problemi o domande, controlla:
1. La sezione Troubleshooting
2. I log nella GUI di monitoraggio
3. La configurazione nei file dei moduli 